<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1>Random Dog Breed Image</h1>
    <a>Choose a breed: </a>
    <input list="breeds" id="breedInput">
    <datalist id="breeds"></datalist>
    <a>Choose a sub-breed: </a>
    <input list="sub-breeds" id="sub-breedInput">
    <datalist id="sub-breeds"></datalist>
    <button id="fetch">Fetch Image</button>
    <div id="image"></div>

    <script>

window.addEventListener('DOMContentLoaded', () => {
    const input = document.getElementById('breedInput');
    const subInput = document.getElementById('sub-breedInput');
    const breeds_list = document.getElementById('breeds');
    const sub_breeds_list = document.getElementById('sub-breeds');
    let breedData = {};

    fetch('https://dog.ceo/api/breeds/list/all')
        .then(response => response.json())
        .then(data => {
            breedData = data.message; 
            const key_val = Object.keys(breedData);
            key_val.forEach(breed => {
                const option = document.createElement('option');
                option.value = breed;
                breeds_list.appendChild(option);
            });
        });

    input.addEventListener('input', () => {
        const selectedBreed = input.value;
        const subBreeds = breedData[selectedBreed];
        sub_breeds_list.innerHTML = '';

        if (subBreeds) {
            subBreeds.forEach(sub => {
                const sub_option = document.createElement('option');
                sub_option.value = sub;
                sub_breeds_list.appendChild(sub_option);
            });
        }
    });

    document.getElementById('fetch').addEventListener('click', () => {
        const breed = input.value; 
        const sub_breed = subInput.value;
        if (breed) {
            if(sub_breed){
                url = `https://dog.ceo/api/breed/${breed}/${sub_breed}/images/random`
            }
            else{
                url = `https://dog.ceo/api/breed/${breed}/images/random`
            }
                fetch(url)
                .then(response => response.json())
                .then(data => {
                    const img_url = data.message;
                    const img_div = document.getElementById('image');
                    img_div.innerHTML = `<img src="${img_url}" alt="${breed} 사진">`;
                    input.value = '';
                    subInput.value = '';
                });
            }
        });
    });

        
    </script>
</body>
</html>